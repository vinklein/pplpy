image: ubuntu:16.04

before_script:
  - apt-get -qq update
  - echo Y | apt-get install apt-utils python-pip git
  - echo Y | apt-get install libgmp-dev libmpfr-dev libmpc-dev libppl-dev
  - pip install Cython --verbose --disable-pip-version-check
  - pip install git+https://github.com/aleaxit/gmpy
  - pip install cysignals --verbose --disable-pip-version-check
  - pip install . --verbose --no-index
  - echo Y | apt-get install software-properties-common python-software-properties
  - add-apt-repository universe

python3:
  stage: build
  script:
  - echo Y | apt-get install python3
  - cd tests
  - python rundoctest.py
  - python setup.py build_ext --inplace
  - python -c "import testpplpy"
  - python setup2.py build_ext --inplace
  - python -c "import testpplpy2"
dk pplpy
