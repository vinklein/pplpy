image: ubuntu:16.04
before_script:
  - apt-get -qq update
  - printf "Y" | apt-get install apt-utils python-pip git
  - printf "Y" | apt-get install libgmp-dev libmpfr-dev libmpc-dev libppl-dev
  - pip install Cython --verbose --disable-pip-version-check
  - pip install git+https://github.com/aleaxit/gmpy
  - pip install cysignals --verbose --disable-pip-version-check
  - pip install . --verbose --no-index
  - printf "Y" | apt-get install software-properties-common python-software-properties
  - add-apt-repository universe

python2.7:
  stage: test
  script:
  - printf "Y" | apt-get install python=2.7.12-1~16.04
  - cd tests
  - python rundoctest.py
  - python setup.py build_ext --inplace
  - python -c "import testpplpy"
  - python setup2.py build_ext --inplace
  - python -c "import testpplpy2"

python3.5:
  stage: test
  script:
  - printf "Y" | apt-get install python=3.5.1-3
  - cd tests
  - python rundoctest.py
  - python setup.py build_ext --inplace
  - python -c "import testpplpy"
  - python setup2.py build_ext --inplace
  - python -c "import testpplpy2"

python3.6:
  stage: test
  script:
  - printf "\n" | add-apt-repository ppa:deadsnakes/ppa
  - apt-get update -qq
  - printf "Y" | apt-get install python3.6
  - cd tests
  - python rundoctest.py
  - python setup.py build_ext --inplace
  - python -c "import testpplpy"
  - python setup2.py build_ext --inplace
  - python -c "import testpplpy2"
